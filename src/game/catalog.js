import { TAU } from "./config.js";

// Gameplay catalogs and definitions
export const BODY_ITEMS = {
  APPLE: { color: "#ff5f6a", deltaSegments: 1 },
  CACTUS: { color: "#4fd17b", deltaSegments: -1 },
};
export const SNAKE_SPRITES_BASE_PATH = "/assets/sprites/snakes";
export const ITEM_SPRITES_BASE_PATH = "/assets/sprites/items";
export const ITEM_SPRITES = {
  BOOST: { key: "item_boost", path: `${ITEM_SPRITES_BASE_PATH}/boost.png` },
  SHIELD: { key: "item_shield", path: `${ITEM_SPRITES_BASE_PATH}/shield.png` },
  OIL: { key: "item_oil", path: `${ITEM_SPRITES_BASE_PATH}/oil.png` },
  BOMB: { key: "item_bomb", path: `${ITEM_SPRITES_BASE_PATH}/bomb.png` },
  APPLE: { key: "item_apple", path: `${ITEM_SPRITES_BASE_PATH}/apple.png` },
  CACTUS: { key: "item_cactus", path: `${ITEM_SPRITES_BASE_PATH}/cactus.png` },
};

export const SNAKES = [
  {
    id: "speedster",
    name: "Speedster",
    flavor: "Максималка выше всех, но тяжелее повернуть",
    color: "#58f4ff",
    stats: { maxSpeed: 238, accel: 330, drag: 1.3, turnRate: 2.52, offroadPenalty: 0.63, mass: 1.0 },
    body: { segments: 18, spacing: 7.6, waveAmp: 4.8, waveFreq: 0.9, waveSpeed: 5.2, taper: 0.62 },
    venom: { range: 128, cooldownMs: 2650, slowMul: 0.9, durationMs: 1450, speed: 385 },
  },
  {
    id: "handler",
    name: "Handler",
    flavor: "Лучший контроль в поворотах",
    color: "#9fff77",
    stats: { maxSpeed: 214, accel: 318, drag: 1.25, turnRate: 3.0, offroadPenalty: 0.67, mass: 1.0 },
    body: { segments: 16, spacing: 8.4, waveAmp: 3.2, waveFreq: 1.15, waveSpeed: 4.1, taper: 0.56 },
    venom: { range: 168, cooldownMs: 2450, slowMul: 0.86, durationMs: 1650, speed: 360 },
  },
  {
    id: "bully",
    name: "Bully",
    flavor: "Тяжелый корпус, сильнее толчки",
    color: "#ff8c7c",
    stats: { maxSpeed: 206, accel: 292, drag: 1.18, turnRate: 2.3, offroadPenalty: 0.71, mass: 1.35 },
    body: { segments: 22, spacing: 8.8, waveAmp: 2.6, waveFreq: 0.72, waveSpeed: 3.1, taper: 0.72 },
    venom: { range: 182, cooldownMs: 2520, slowMul: 0.83, durationMs: 1800, speed: 342 },
  },
  {
    id: "trickster",
    name: "Trickster",
    flavor: "Почти не теряет темп вне дороги",
    color: "#d6a7ff",
    stats: { maxSpeed: 222, accel: 305, drag: 1.22, turnRate: 2.72, offroadPenalty: 0.82, mass: 0.95 },
    body: { segments: 15, spacing: 7.1, waveAmp: 5.3, waveFreq: 1.32, waveSpeed: 6.0, taper: 0.52 },
    venom: { range: 212, cooldownMs: 2200, slowMul: 0.81, durationMs: 1900, speed: 372 },
  },
];

export function snakeHeadTextureKey(snakeId) {
  return `snake_head_${snakeId}`;
}

export function snakeSegmentTextureKey(snakeId) {
  return `snake_segment_${snakeId}`;
}

export function snakeHeadTexturePath(snakeId) {
  return `${SNAKE_SPRITES_BASE_PATH}/${snakeId}/head.png`;
}

export function snakeSegmentTexturePath(snakeId) {
  return `${SNAKE_SPRITES_BASE_PATH}/${snakeId}/segment.png`;
}

export const PICKUP_TYPES = {
  BOOST: { name: "BOOST", color: "#44f084", durationMs: 2600 },
  SHIELD: { name: "SHIELD", color: "#63cfff", durationMs: 6500, charges: 1 },
  OIL: { name: "OIL", color: "#ffc45f", durationMs: 2200 },
  BOMB: { name: "BOMB", color: "#ff6975", durationMs: 1450, radius: 86 },
};

export const PICKUP_ORDER = ["BOOST", "SHIELD", "OIL", "BOMB"];

export const NPC_PROFILES = [
  { id: "careful", name: "аккуратный", speedFactor: 0.88, lookAhead: 130, steerGain: 2.2, brakeAngle: 0.48 },
  { id: "normal", name: "ровный", speedFactor: 0.95, lookAhead: 145, steerGain: 2.45, brakeAngle: 0.56 },
  { id: "aggressive", name: "агро", speedFactor: 1.02, lookAhead: 160, steerGain: 2.65, brakeAngle: 0.66 },
  { id: "maniac", name: "маньяк", speedFactor: 1.08, lookAhead: 172, steerGain: 2.85, brakeAngle: 0.76 },
];

const TRACK_DEFS_ALL = [
  {
    id: "canyon_loop",
    name: "Canyon Loop",
    subtitle: "Быстрая трасса с затяжными связками",
    roadWidth: 52,
    outsideWidth: 90,
    checkpointFractions: [0, 0.15, 0.33, 0.49, 0.68, 0.84],
    pickupFractions: [0.07, 0.21, 0.31, 0.42, 0.58, 0.73, 0.86, 0.93],
    createPoints: () => [
      { x: 881.52, y: 298.41 },
      { x: 881.11, y: 312.28 },
      { x: 880.71, y: 326.15 },
      { x: 880.31, y: 340.02 },
      { x: 879.90, y: 353.89 },
      { x: 877.41, y: 366.69 },
      { x: 872.81, y: 378.43 },
      { x: 867.62, y: 389.89 },
      { x: 861.61, y: 400.97 },
      { x: 853.42, y: 411.03 },
      { x: 844.47, y: 420.24 },
      { x: 835.30, y: 428.83 },
      { x: 825.50, y: 435.72 },
      { x: 815.06, y: 440.89 },
      { x: 803.99, y: 444.33 },
      { x: 792.60, y: 446.92 },
      { x: 780.91, y: 448.67 },
      { x: 769.19, y: 450.36 },
      { x: 757.17, y: 451.22 },
      { x: 745.15, y: 450.36 },
      { x: 732.81, y: 450.36 },
      { x: 720.79, y: 449.50 },
      { x: 709.08, y: 447.78 },
      { x: 697.70, y: 445.19 },
      { x: 685.99, y: 443.47 },
      { x: 674.29, y: 441.75 },
      { x: 662.58, y: 440.03 },
      { x: 650.56, y: 439.17 },
      { x: 638.99, y: 437.09 },
      { x: 627.47, y: 434.86 },
      { x: 615.76, y: 433.14 },
      { x: 603.84, y: 432.01 },
      { x: 592.04, y: 430.56 },
      { x: 580.02, y: 429.69 },
      { x: 568.47, y: 427.54 },
      { x: 556.61, y: 426.25 },
      { x: 544.52, y: 425.57 },
      { x: 532.56, y: 424.53 },
      { x: 520.54, y: 423.67 },
      { x: 508.52, y: 422.81 },
      { x: 496.50, y: 421.94 },
      { x: 484.75, y: 420.34 },
      { x: 472.88, y: 421.39 },
      { x: 461.07, y: 422.81 },
      { x: 449.36, y: 424.53 },
      { x: 437.66, y: 426.25 },
      { x: 426.55, y: 429.59 },
      { x: 415.52, y: 433.14 },
      { x: 404.45, y: 436.58 },
      { x: 393.42, y: 440.15 },
      { x: 382.94, y: 445.19 },
      { x: 372.50, y: 450.36 },
      { x: 362.09, y: 455.59 },
      { x: 351.79, y: 461.14 },
      { x: 341.51, y: 466.72 },
      { x: 331.43, y: 472.85 },
      { x: 321.36, y: 479.01 },
      { x: 311.29, y: 485.17 },
      { x: 302.66, y: 494.02 },
      { x: 293.48, y: 502.61 },
      { x: 283.86, y: 509.99 },
      { x: 273.66, y: 515.81 },
      { x: 262.82, y: 519.87 },
      { x: 251.52, y: 522.69 },
      { x: 239.99, y: 524.89 },
      { x: 228.43, y: 527.00 },
      { x: 216.41, y: 527.86 },
      { x: 204.39, y: 527.00 },
      { x: 192.68, y: 525.28 },
      { x: 180.98, y: 523.56 },
      { x: 169.91, y: 520.11 },
      { x: 159.41, y: 515.12 },
      { x: 149.03, y: 509.78 },
      { x: 138.91, y: 503.75 },
      { x: 129.42, y: 496.03 },
      { x: 121.01, y: 486.57 },
      { x: 112.29, y: 476.76 },
      { x: 104.10, y: 466.70 },
      { x: 97.23, y: 456.02 },
      { x: 92.07, y: 444.55 },
      { x: 89.58, y: 431.83 },
      { x: 87.61, y: 418.87 },
      { x: 85.75, y: 405.86 },
      { x: 83.45, y: 393.05 },
      { x: 84.98, y: 379.88 },
      { x: 87.28, y: 367.08 },
      { x: 91.11, y: 354.98 },
      { x: 97.00, y: 343.85 },
      { x: 105.41, y: 334.39 },
      { x: 114.80, y: 326.41 },
      { x: 124.88, y: 320.25 },
      { x: 135.17, y: 314.69 },
      { x: 145.46, y: 309.14 },
      { x: 155.98, y: 304.20 },
      { x: 166.97, y: 300.53 },
      { x: 177.92, y: 296.75 },
      { x: 188.21, y: 291.20 },
      { x: 198.28, y: 285.03 },
      { x: 206.69, y: 275.59 },
      { x: 213.79, y: 265.02 },
      { x: 218.19, y: 253.19 },
      { x: 220.96, y: 240.60 },
      { x: 223.56, y: 227.93 },
      { x: 226.50, y: 215.42 },
      { x: 228.92, y: 202.68 },
      { x: 231.22, y: 189.87 },
      { x: 233.52, y: 177.06 },
      { x: 237.34, y: 164.97 },
      { x: 242.51, y: 153.49 },
      { x: 249.61, y: 142.93 },
      { x: 258.78, y: 134.33 },
      { x: 268.18, y: 126.34 },
      { x: 277.58, y: 118.36 },
      { x: 287.24, y: 111.08 },
      { x: 297.99, y: 106.78 },
      { x: 309.06, y: 103.33 },
      { x: 320.10, y: 99.81 },
      { x: 331.52, y: 97.31 },
      { x: 343.23, y: 95.58 },
      { x: 354.93, y: 93.86 },
      { x: 366.95, y: 93.00 },
      { x: 378.98, y: 93.86 },
      { x: 390.68, y: 95.58 },
      { x: 402.38, y: 97.31 },
      { x: 414.09, y: 99.03 },
      { x: 425.76, y: 100.83 },
      { x: 436.73, y: 104.56 },
      { x: 447.62, y: 108.50 },
      { x: 457.74, y: 114.53 },
      { x: 466.94, y: 123.04 },
      { x: 476.34, y: 131.02 },
      { x: 485.29, y: 140.23 },
      { x: 491.31, y: 151.30 },
      { x: 495.70, y: 163.13 },
      { x: 500.64, y: 174.71 },
      { x: 505.03, y: 186.54 },
      { x: 508.88, y: 198.63 },
      { x: 512.97, y: 210.60 },
      { x: 519.84, y: 221.28 },
      { x: 528.24, y: 230.74 },
      { x: 538.98, y: 235.08 },
      { x: 550.37, y: 237.67 },
      { x: 561.59, y: 240.69 },
      { x: 572.83, y: 243.69 },
      { x: 584.21, y: 241.11 },
      { x: 595.39, y: 237.96 },
      { x: 606.36, y: 234.24 },
      { x: 616.43, y: 228.08 },
      { x: 625.83, y: 220.09 },
      { x: 634.01, y: 210.03 },
      { x: 642.42, y: 200.57 },
      { x: 651.82, y: 192.58 },
      { x: 661.22, y: 184.60 },
      { x: 670.61, y: 176.61 },
      { x: 680.68, y: 170.45 },
      { x: 690.76, y: 164.29 },
      { x: 701.05, y: 158.74 },
      { x: 712.01, y: 155.00 },
      { x: 723.08, y: 151.56 },
      { x: 734.47, y: 148.97 },
      { x: 746.17, y: 147.25 },
      { x: 757.88, y: 145.53 },
      { x: 769.90, y: 144.67 },
      { x: 781.92, y: 145.53 },
      { x: 793.94, y: 146.39 },
      { x: 805.65, y: 148.11 },
      { x: 817.35, y: 149.83 },
      { x: 828.42, y: 153.28 },
      { x: 839.18, y: 157.58 },
      { x: 849.23, y: 163.78 },
      { x: 858.78, y: 171.36 },
      { x: 865.41, y: 181.98 },
      { x: 870.89, y: 193.31 },
      { x: 875.11, y: 205.22 },
      { x: 879.70, y: 216.96 },
      { x: 883.53, y: 229.06 },
      { x: 883.13, y: 242.93 },
      { x: 882.73, y: 256.80 },
      { x: 882.32, y: 270.67 },
      { x: 881.92, y: 284.54 },
    ],
  },
  {
    id: "switchback_run",
    name: "Switchback Run",
    subtitle: "Больше смен темпа и двойные апексы",
    roadWidth: 50,
    outsideWidth: 88,
    checkpointFractions: [0, 0.12, 0.25, 0.4, 0.56, 0.74, 0.88],
    pickupFractions: [0.05, 0.16, 0.29, 0.39, 0.51, 0.64, 0.79, 0.9],
    createPoints: () => [
      { x: 68.76, y: 307.23 },
      { x: 69.64, y: 298.38 },
      { x: 70.94, y: 289.58 },
      { x: 72.65, y: 280.86 },
      { x: 74.70, y: 272.20 },
      { x: 76.99, y: 263.61 },
      { x: 79.46, y: 255.07 },
      { x: 82.16, y: 246.59 },
      { x: 85.09, y: 238.19 },
      { x: 88.27, y: 229.89 },
      { x: 91.79, y: 221.72 },
      { x: 95.67, y: 213.72 },
      { x: 99.87, y: 205.88 },
      { x: 104.38, y: 198.21 },
      { x: 109.19, y: 190.73 },
      { x: 114.31, y: 183.47 },
      { x: 119.77, y: 176.44 },
      { x: 125.58, y: 169.71 },
      { x: 131.72, y: 163.28 },
      { x: 138.09, y: 157.08 },
      { x: 144.69, y: 151.12 },
      { x: 151.52, y: 145.42 },
      { x: 158.58, y: 140.01 },
      { x: 165.92, y: 134.98 },
      { x: 173.52, y: 130.37 },
      { x: 181.42, y: 126.29 },
      { x: 189.60, y: 122.81 },
      { x: 197.98, y: 119.84 },
      { x: 206.52, y: 117.37 },
      { x: 215.18, y: 115.35 },
      { x: 223.93, y: 113.76 },
      { x: 232.76, y: 112.68 },
      { x: 241.63, y: 112.09 },
      { x: 250.52, y: 112.09 },
      { x: 259.39, y: 112.71 },
      { x: 268.21, y: 113.90 },
      { x: 276.92, y: 115.65 },
      { x: 285.50, y: 117.98 },
      { x: 293.86, y: 121.02 },
      { x: 301.85, y: 124.92 },
      { x: 309.28, y: 129.79 },
      { x: 316.06, y: 135.54 },
      { x: 322.05, y: 142.11 },
      { x: 327.03, y: 149.46 },
      { x: 330.71, y: 157.54 },
      { x: 332.58, y: 166.20 },
      { x: 332.21, y: 175.07 },
      { x: 330.53, y: 183.80 },
      { x: 328.21, y: 192.39 },
      { x: 325.67, y: 200.91 },
      { x: 323.29, y: 209.48 },
      { x: 321.28, y: 218.15 },
      { x: 318.98, y: 226.73 },
      { x: 316.38, y: 235.24 },
      { x: 313.83, y: 243.76 },
      { x: 311.62, y: 252.37 },
      { x: 310.17, y: 261.14 },
      { x: 310.00, y: 270.03 },
      { x: 311.18, y: 278.84 },
      { x: 313.26, y: 287.48 },
      { x: 316.12, y: 295.90 },
      { x: 319.72, y: 304.03 },
      { x: 324.07, y: 311.79 },
      { x: 329.23, y: 319.02 },
      { x: 335.31, y: 325.50 },
      { x: 342.18, y: 331.14 },
      { x: 349.61, y: 336.01 },
      { x: 357.46, y: 340.19 },
      { x: 365.61, y: 343.74 },
      { x: 374.00, y: 346.68 },
      { x: 382.61, y: 348.91 },
      { x: 391.37, y: 350.39 },
      { x: 400.23, y: 351.21 },
      { x: 409.12, y: 351.45 },
      { x: 418.00, y: 351.16 },
      { x: 426.86, y: 350.38 },
      { x: 435.67, y: 349.13 },
      { x: 444.40, y: 347.43 },
      { x: 453.02, y: 345.28 },
      { x: 461.52, y: 342.64 },
      { x: 469.83, y: 339.50 },
      { x: 477.92, y: 335.81 },
      { x: 485.73, y: 331.55 },
      { x: 493.17, y: 326.68 },
      { x: 500.25, y: 321.30 },
      { x: 507.03, y: 315.55 },
      { x: 513.57, y: 309.52 },
      { x: 519.86, y: 303.23 },
      { x: 525.96, y: 296.76 },
      { x: 531.89, y: 290.13 },
      { x: 537.40, y: 283.16 },
      { x: 542.40, y: 275.80 },
      { x: 547.03, y: 268.21 },
      { x: 551.52, y: 260.53 },
      { x: 556.10, y: 252.91 },
      { x: 560.99, y: 245.48 },
      { x: 566.30, y: 238.35 },
      { x: 571.83, y: 231.38 },
      { x: 577.47, y: 224.50 },
      { x: 583.20, y: 217.71 },
      { x: 589.07, y: 211.03 },
      { x: 595.09, y: 204.48 },
      { x: 601.31, y: 198.12 },
      { x: 607.77, y: 192.00 },
      { x: 614.52, y: 186.22 },
      { x: 621.55, y: 180.78 },
      { x: 628.87, y: 175.73 },
      { x: 636.47, y: 171.10 },
      { x: 644.31, y: 166.91 },
      { x: 652.37, y: 163.14 },
      { x: 660.58, y: 159.74 },
      { x: 668.93, y: 156.68 },
      { x: 677.42, y: 154.03 },
      { x: 686.06, y: 151.91 },
      { x: 694.83, y: 150.49 },
      { x: 703.70, y: 150.00 },
      { x: 712.56, y: 150.73 },
      { x: 721.24, y: 152.65 },
      { x: 729.67, y: 155.47 },
      { x: 737.85, y: 158.94 },
      { x: 745.85, y: 162.84 },
      { x: 753.69, y: 167.04 },
      { x: 761.24, y: 171.73 },
      { x: 768.51, y: 176.85 },
      { x: 775.52, y: 182.32 },
      { x: 782.32, y: 188.06 },
      { x: 788.93, y: 194.01 },
      { x: 795.34, y: 200.17 },
      { x: 801.52, y: 206.57 },
      { x: 807.49, y: 213.16 },
      { x: 813.26, y: 219.92 },
      { x: 818.84, y: 226.85 },
      { x: 824.22, y: 233.94 },
      { x: 829.36, y: 241.19 },
      { x: 834.25, y: 248.62 },
      { x: 838.82, y: 256.25 },
      { x: 843.02, y: 264.09 },
      { x: 846.78, y: 272.14 },
      { x: 850.11, y: 280.39 },
      { x: 853.05, y: 288.78 },
      { x: 855.59, y: 297.30 },
      { x: 857.68, y: 305.95 },
      { x: 859.29, y: 314.69 },
      { x: 860.35, y: 323.52 },
      { x: 860.83, y: 332.40 },
      { x: 860.79, y: 341.29 },
      { x: 860.22, y: 350.17 },
      { x: 859.08, y: 358.99 },
      { x: 857.41, y: 367.72 },
      { x: 855.26, y: 376.35 },
      { x: 852.61, y: 384.84 },
      { x: 849.44, y: 393.15 },
      { x: 845.71, y: 401.22 },
      { x: 841.39, y: 408.99 },
      { x: 836.50, y: 416.42 },
      { x: 831.15, y: 423.52 },
      { x: 825.43, y: 430.33 },
      { x: 819.39, y: 436.85 },
      { x: 813.08, y: 443.12 },
      { x: 806.51, y: 449.11 },
      { x: 799.66, y: 454.79 },
      { x: 792.60, y: 460.19 },
      { x: 785.34, y: 465.34 },
      { x: 777.90, y: 470.21 },
      { x: 770.26, y: 474.75 },
      { x: 762.27, y: 478.64 },
      { x: 753.78, y: 481.26 },
      { x: 745.08, y: 483.13 },
      { x: 736.51, y: 485.47 },
      { x: 728.20, y: 488.65 },
      { x: 720.00, y: 492.08 },
      { x: 711.92, y: 495.80 },
      { x: 703.99, y: 499.83 },
      { x: 696.30, y: 504.28 },
      { x: 689.15, y: 509.58 },
      { x: 682.21, y: 515.13 },
      { x: 675.00, y: 520.34 },
      { x: 667.35, y: 524.87 },
      { x: 659.30, y: 528.64 },
      { x: 651.00, y: 531.82 },
      { x: 642.59, y: 534.71 },
      { x: 634.11, y: 537.41 },
      { x: 625.60, y: 539.97 },
      { x: 617.04, y: 542.39 },
      { x: 608.45, y: 544.69 },
      { x: 599.82, y: 546.87 },
      { x: 591.17, y: 548.92 },
      { x: 582.48, y: 550.83 },
      { x: 573.76, y: 552.58 },
      { x: 565.01, y: 554.16 },
      { x: 556.23, y: 555.55 },
      { x: 547.41, y: 556.74 },
      { x: 538.58, y: 557.75 },
      { x: 529.72, y: 558.59 },
      { x: 520.86, y: 559.27 },
      { x: 511.98, y: 559.78 },
      { x: 503.09, y: 560.14 },
      { x: 494.20, y: 560.34 },
      { x: 485.30, y: 560.41 },
      { x: 476.41, y: 560.35 },
      { x: 467.52, y: 560.16 },
      { x: 458.63, y: 559.85 },
      { x: 449.75, y: 559.38 },
      { x: 440.88, y: 558.76 },
      { x: 432.02, y: 557.99 },
      { x: 423.17, y: 557.10 },
      { x: 414.33, y: 556.09 },
      { x: 405.51, y: 554.97 },
      { x: 396.70, y: 553.77 },
      { x: 387.89, y: 552.49 },
      { x: 379.10, y: 551.13 },
      { x: 370.32, y: 549.72 },
      { x: 361.55, y: 548.26 },
      { x: 352.78, y: 546.76 },
      { x: 344.03, y: 545.21 },
      { x: 335.28, y: 543.61 },
      { x: 326.54, y: 541.93 },
      { x: 317.82, y: 540.17 },
      { x: 309.13, y: 538.32 },
      { x: 300.45, y: 536.36 },
      { x: 291.80, y: 534.28 },
      { x: 283.19, y: 532.08 },
      { x: 274.61, y: 529.73 },
      { x: 266.07, y: 527.23 },
      { x: 257.58, y: 524.59 },
      { x: 249.12, y: 521.85 },
      { x: 240.69, y: 519.01 },
      { x: 232.30, y: 516.07 },
      { x: 223.94, y: 513.02 },
      { x: 215.63, y: 509.86 },
      { x: 207.37, y: 506.56 },
      { x: 199.17, y: 503.12 },
      { x: 191.04, y: 499.52 },
      { x: 182.98, y: 495.74 },
      { x: 175.03, y: 491.77 },
      { x: 167.20, y: 487.54 },
      { x: 159.51, y: 483.08 },
      { x: 151.94, y: 478.40 },
      { x: 144.51, y: 473.53 },
      { x: 137.20, y: 468.46 },
      { x: 130.03, y: 463.20 },
      { x: 122.99, y: 457.76 },
      { x: 116.14, y: 452.09 },
      { x: 109.46, y: 446.22 },
      { x: 102.99, y: 440.11 },
      { x: 96.84, y: 433.70 },
      { x: 91.10, y: 426.90 },
      { x: 86.00, y: 419.62 },
      { x: 81.62, y: 411.89 },
      { x: 78.00, y: 403.77 },
      { x: 75.04, y: 395.39 },
      { x: 72.52, y: 386.86 },
      { x: 70.46, y: 378.21 },
      { x: 69.11, y: 369.42 },
      { x: 68.30, y: 360.56 },
      { x: 67.90, y: 351.68 },
      { x: 67.78, y: 342.79 },
      { x: 67.84, y: 333.89 },
      { x: 68.00, y: 325.00 },
      { x: 68.25, y: 316.11 },
    ],
  },
  {
    id: "twin_fang",
    name: "Twin Fang",
    subtitle: "Почти восьмерка с коварными перекладками",
    roadWidth: 48,
    outsideWidth: 86,
    checkpointFractions: [0, 0.11, 0.26, 0.43, 0.57, 0.72, 0.87],
    pickupFractions: [0.04, 0.17, 0.27, 0.36, 0.53, 0.68, 0.81, 0.92],
    createPoints: () => [
      { x: 130.00, y: 300.00 },
      { x: 132.60, y: 289.60 },
      { x: 135.74, y: 279.35 },
      { x: 139.75, y: 269.42 },
      { x: 144.97, y: 260.06 },
      { x: 151.35, y: 251.45 },
      { x: 158.49, y: 243.46 },
      { x: 166.23, y: 236.05 },
      { x: 174.45, y: 229.17 },
      { x: 183.10, y: 222.84 },
      { x: 192.02, y: 216.90 },
      { x: 201.22, y: 211.39 },
      { x: 210.61, y: 206.22 },
      { x: 220.19, y: 201.42 },
      { x: 229.99, y: 197.07 },
      { x: 239.96, y: 193.13 },
      { x: 250.06, y: 189.53 },
      { x: 260.29, y: 186.33 },
      { x: 270.64, y: 183.52 },
      { x: 281.08, y: 181.12 },
      { x: 291.63, y: 179.18 },
      { x: 302.25, y: 177.76 },
      { x: 312.92, y: 176.74 },
      { x: 323.62, y: 176.06 },
      { x: 334.33, y: 175.74 },
      { x: 345.05, y: 175.77 },
      { x: 355.77, y: 176.18 },
      { x: 366.45, y: 177.03 },
      { x: 377.10, y: 178.31 },
      { x: 387.68, y: 179.99 },
      { x: 398.21, y: 182.02 },
      { x: 408.66, y: 184.41 },
      { x: 419.02, y: 187.15 },
      { x: 429.28, y: 190.27 },
      { x: 439.40, y: 193.80 },
      { x: 449.37, y: 197.74 },
      { x: 458.98, y: 202.48 },
      { x: 468.14, y: 208.05 },
      { x: 477.01, y: 214.06 },
      { x: 485.75, y: 220.28 },
      { x: 494.50, y: 226.47 },
      { x: 503.49, y: 232.31 },
      { x: 513.03, y: 237.15 },
      { x: 523.40, y: 239.60 },
      { x: 533.93, y: 238.19 },
      { x: 543.52, y: 233.44 },
      { x: 553.00, y: 228.43 },
      { x: 562.01, y: 222.63 },
      { x: 570.49, y: 216.08 },
      { x: 578.93, y: 209.47 },
      { x: 587.56, y: 203.12 },
      { x: 596.11, y: 196.64 },
      { x: 604.57, y: 190.05 },
      { x: 613.14, y: 183.61 },
      { x: 621.96, y: 177.53 },
      { x: 631.18, y: 172.07 },
      { x: 640.73, y: 167.20 },
      { x: 650.44, y: 162.65 },
      { x: 660.31, y: 158.47 },
      { x: 670.36, y: 154.75 },
      { x: 680.62, y: 151.64 },
      { x: 691.07, y: 149.27 },
      { x: 701.69, y: 147.86 },
      { x: 712.39, y: 147.13 },
      { x: 723.10, y: 146.89 },
      { x: 733.82, y: 147.13 },
      { x: 744.51, y: 147.88 },
      { x: 755.15, y: 149.19 },
      { x: 765.68, y: 151.13 },
      { x: 776.05, y: 153.82 },
      { x: 786.15, y: 157.40 },
      { x: 795.91, y: 161.82 },
      { x: 805.32, y: 166.95 },
      { x: 814.39, y: 172.67 },
      { x: 823.11, y: 178.90 },
      { x: 831.47, y: 185.61 },
      { x: 839.49, y: 192.73 },
      { x: 847.12, y: 200.24 },
      { x: 854.32, y: 208.19 },
      { x: 861.02, y: 216.55 },
      { x: 867.24, y: 225.28 },
      { x: 872.93, y: 234.36 },
      { x: 878.04, y: 243.78 },
      { x: 882.46, y: 253.55 },
      { x: 886.14, y: 263.61 },
      { x: 888.98, y: 273.94 },
      { x: 891.03, y: 284.46 },
      { x: 892.37, y: 295.10 },
      { x: 892.97, y: 305.80 },
      { x: 892.93, y: 316.52 },
      { x: 892.25, y: 327.21 },
      { x: 890.87, y: 337.84 },
      { x: 888.66, y: 348.33 },
      { x: 885.70, y: 358.63 },
      { x: 881.98, y: 368.68 },
      { x: 877.34, y: 378.34 },
      { x: 871.73, y: 387.46 },
      { x: 865.16, y: 395.92 },
      { x: 857.59, y: 403.50 },
      { x: 849.34, y: 410.34 },
      { x: 840.45, y: 416.32 },
      { x: 831.01, y: 421.37 },
      { x: 821.14, y: 425.55 },
      { x: 810.88, y: 428.62 },
      { x: 800.35, y: 430.65 },
      { x: 789.71, y: 431.93 },
      { x: 779.02, y: 432.59 },
      { x: 768.30, y: 432.75 },
      { x: 757.58, y: 432.43 },
      { x: 746.89, y: 431.69 },
      { x: 736.25, y: 430.38 },
      { x: 725.70, y: 428.51 },
      { x: 715.23, y: 426.20 },
      { x: 704.85, y: 423.51 },
      { x: 694.55, y: 420.54 },
      { x: 684.31, y: 417.37 },
      { x: 674.13, y: 414.00 },
      { x: 664.07, y: 410.30 },
      { x: 654.17, y: 406.20 },
      { x: 644.38, y: 401.84 },
      { x: 634.68, y: 397.26 },
      { x: 625.06, y: 392.52 },
      { x: 615.50, y: 387.68 },
      { x: 606.04, y: 382.64 },
      { x: 596.67, y: 377.43 },
      { x: 587.38, y: 372.08 },
      { x: 578.13, y: 366.66 },
      { x: 568.90, y: 361.21 },
      { x: 559.65, y: 355.78 },
      { x: 550.67, y: 349.93 },
      { x: 542.01, y: 343.62 },
      { x: 533.27, y: 337.41 },
      { x: 523.65, y: 332.77 },
      { x: 513.10, y: 332.80 },
      { x: 503.85, y: 338.06 },
      { x: 495.76, y: 345.08 },
      { x: 487.61, y: 352.06 },
      { x: 479.80, y: 359.39 },
      { x: 472.30, y: 367.05 },
      { x: 464.77, y: 374.69 },
      { x: 457.00, y: 382.07 },
      { x: 448.77, y: 388.94 },
      { x: 440.20, y: 395.37 },
      { x: 431.43, y: 401.54 },
      { x: 422.45, y: 407.40 },
      { x: 413.28, y: 412.93 },
      { x: 403.85, y: 418.03 },
      { x: 394.22, y: 422.76 },
      { x: 384.45, y: 427.16 },
      { x: 374.53, y: 431.22 },
      { x: 364.48, y: 434.94 },
      { x: 354.27, y: 438.23 },
      { x: 343.93, y: 441.04 },
      { x: 333.46, y: 443.35 },
      { x: 322.90, y: 445.20 },
      { x: 312.27, y: 446.60 },
      { x: 301.60, y: 447.59 },
      { x: 290.90, y: 448.14 },
      { x: 280.18, y: 448.14 },
      { x: 269.47, y: 447.63 },
      { x: 258.80, y: 446.57 },
      { x: 248.21, y: 444.93 },
      { x: 237.71, y: 442.80 },
      { x: 227.33, y: 440.09 },
      { x: 217.15, y: 436.76 },
      { x: 207.23, y: 432.71 },
      { x: 197.67, y: 427.86 },
      { x: 188.51, y: 422.30 },
      { x: 179.75, y: 416.12 },
      { x: 171.49, y: 409.29 },
      { x: 163.83, y: 401.80 },
      { x: 156.97, y: 393.57 },
      { x: 150.80, y: 384.80 },
      { x: 145.21, y: 375.66 },
      { x: 140.03, y: 366.27 },
      { x: 135.49, y: 356.56 },
      { x: 131.71, y: 346.53 },
      { x: 128.84, y: 336.21 },
      { x: 127.22, y: 325.62 },
      { x: 127.32, y: 314.92 },
    ],
  },
  {
    id: "dune_orbit",
    name: "Dune Orbit",
    subtitle: "Песчаный овал с волной по дугам",
    roadWidth: 50,
    outsideWidth: 90,
    checkpointFractions: [0, 0.13, 0.24, 0.37, 0.51, 0.64, 0.78, 0.9],
    pickupFractions: [0.03, 0.11, 0.19, 0.28, 0.4, 0.53, 0.66, 0.74, 0.83, 0.92],
    createPoints: () => {
      const points = [];
      const steps = 210;
      for (let i = 0; i < steps; i += 1) {
        const t = (i / steps) * TAU;
        const x = 490 + Math.cos(t) * 330 + Math.cos(3 * t + 0.5) * 34;
        const y = 312 + Math.sin(t) * 190 + Math.sin(2 * t - 0.8) * 46 + Math.sin(5 * t) * 12;
        points.push({ x, y });
      }
      return points;
    },
  },
  {
    id: "neon_delta",
    name: "Neon Delta",
    subtitle: "Три прямых зоны и резкие связки",
    roadWidth: 49,
    outsideWidth: 88,
    checkpointFractions: [0, 0.1, 0.22, 0.35, 0.49, 0.61, 0.74, 0.87],
    pickupFractions: [0.05, 0.14, 0.23, 0.31, 0.43, 0.56, 0.67, 0.75, 0.86, 0.94],
    createPoints: () => {
      const points = [];
      const steps = 240;
      for (let i = 0; i < steps; i += 1) {
        const t = (i / steps) * TAU;
        const triangleX = Math.asin(Math.sin(t)) * (2 / Math.PI);
        const triangleY = Math.asin(Math.sin(t + 1.2)) * (2 / Math.PI);
        const x = 490 + triangleX * 315 + Math.sin(4 * t) * 26 + Math.cos(2 * t - 0.2) * 20;
        const y = 312 + triangleY * 170 + Math.sin(3 * t + 0.3) * 34;
        points.push({ x, y });
      }
      return points;
    },
  },
  {
    id: "volcano_spiral",
    name: "Вулканическая спираль",
    subtitle: "Узкие дуги и пульсирующие связки в поворотах",
    roadWidth: 50,
    outsideWidth: 90,
    checkpointFractions: [0, 0.09, 0.2, 0.32, 0.46, 0.6, 0.73, 0.86],
    pickupFractions: [0.04, 0.12, 0.18, 0.27, 0.38, 0.49, 0.58, 0.69, 0.81, 0.93],
    createPoints: () => {
      const points = [];
      const steps = 240;
      for (let i = 0; i < steps; i += 1) {
        const t = (i / steps) * TAU;
        const x = 490 + Math.cos(t) * 308 + Math.cos(2 * t + 1.1) * 76 + Math.sin(5 * t + 0.2) * 14;
        const y = 310 + Math.sin(t) * 176 + Math.sin(3 * t - 0.35) * 62 + Math.cos(4 * t + 0.6) * 11;
        points.push({ x, y });
      }
      return points;
    },
  },
  {
    id: "glacier_chicane",
    name: "Ледяная шикана",
    subtitle: "Длинные прямые с быстрыми шиканами и перекладками",
    roadWidth: 51,
    outsideWidth: 92,
    checkpointFractions: [0, 0.11, 0.23, 0.35, 0.48, 0.61, 0.74, 0.88],
    pickupFractions: [0.03, 0.14, 0.22, 0.3, 0.41, 0.52, 0.63, 0.72, 0.84, 0.95],
    createPoints: () => {
      const points = [];
      const steps = 250;
      for (let i = 0; i < steps; i += 1) {
        const t = (i / steps) * TAU;
        const triX = Math.asin(Math.sin(t)) * (2 / Math.PI);
        const triY = Math.asin(Math.sin(t + 1.5)) * (2 / Math.PI);
        const x = 490 + triX * 324 + Math.sin(3 * t + 0.15) * 34 + Math.cos(5 * t) * 10;
        const y = 312 + triY * 182 + Math.sin(2 * t + 0.65) * 28 + Math.sin(6 * t - 0.4) * 13;
        points.push({ x, y });
      }
      return points;
    },
  },
];

const ENABLED_TRACK_IDS = new Set(["canyon_loop", "switchback_run", "twin_fang"]);

export const TRACK_DEFS = TRACK_DEFS_ALL.filter((def) => ENABLED_TRACK_IDS.has(def.id));
